#! /bin/sh

# Prepare a freshly checked out copy of
# the CVS tree for compilation.

# $Id: prepare,v 1.6 2004/01/28 00:08:20 tudor Exp $

AMFLAGS=

if [ "$1" = "-a" ]
then
#    gnulib-tool --import fsusage getopt idcache strcase strstr memmove fnmatch fnmatch-gnu rename readlink putenv xalloc ; echo -n .
    gnulib-tool --update; echo -n .
    patch -p0 < lib-Makefile.am.patch ; echo -n .
    AMFLAGS="--add-missing --force-missing --copy"
fi

rm -rf autom4te.cache config.cache; echo -n "."
aclocal; echo -n "."
#libtoolize --automake --copy --force && echo -n "."
autoheader 2>&1 | grep -v "config.h.in"
echo -n "." &&
aclocal -I m4 && echo -n "." &&
automake --foreign $AMFLAGS && echo -n "."
autoconf
echo -n "." &&
echo " done"
